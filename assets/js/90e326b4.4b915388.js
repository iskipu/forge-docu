"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8170],{5680:(e,t,n)=>{n.d(t,{xA:()=>u,yg:()=>d});var r=n(6540);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(n),m=a,d=c["".concat(s,".").concat(m)]||c[m]||g[m]||o;return n?r.createElement(d,i(i({ref:t},u),{},{components:n})):r.createElement(d,i({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:a,i[1]=l;for(var p=2;p<o;p++)i[p]=n[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8213:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>g,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var r=n(8168),a=(n(6540),n(5680));const o={description:"How to publish your distributable Electron app artifacts to Amazon S3"},i="S3",l={unversionedId:"config/publishers/s3",id:"version-old/config/publishers/s3",title:"S3",description:"How to publish your distributable Electron app artifacts to Amazon S3",source:"@site/versioned_docs/version-old/config/publishers/s3.md",sourceDirName:"config/publishers",slug:"/config/publishers/s3",permalink:"/forge-docu/config/publishers/s3",draft:!1,editUrl:"https://github.com/iskipu/forge-docu/edit/main/versioned_docs/version-old/config/publishers/s3.md",tags:[],version:"old",frontMatter:{description:"How to publish your distributable Electron app artifacts to Amazon S3"},sidebar:"tutorialSidebar",previous:{title:"Nucleus",permalink:"/forge-docu/config/publishers/nucleus"},next:{title:"Snapcraft",permalink:"/forge-docu/config/publishers/snapcraft"}},s={},p=[{value:"Authentication",id:"authentication",level:2},{value:"Usage",id:"usage",level:2},{value:"Key management",id:"key-management",level:3},{value:"Auto updating from S3",id:"auto-updating-from-s3",level:3}],u={toc:p},c="wrapper";function g(e){let{components:t,...n}=e;return(0,a.yg)(c,(0,r.A)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"s3"},"S3"),(0,a.yg)("p",null,"The S3 target publishes your Make artifacts to an Amazon S3 bucket."),(0,a.yg)("h2",{id:"authentication"},"Authentication"),(0,a.yg)("p",null,"It is recommended to follow the ",(0,a.yg)("a",{parentName:"p",href:"https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/setting-credentials-node.html"},"Amazon AWS guide")," and set either a shared credentials guide or the proper environment variables. However, if that is not possible, the publisher config allows the setting of the ",(0,a.yg)("inlineCode",{parentName:"p"},"accessKeyId")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"secretAccessKey")," configuration options."),(0,a.yg)("h2",{id:"usage"},"Usage"),(0,a.yg)("p",null,"Configuration options are documented in ",(0,a.yg)("a",{parentName:"p",href:"https://js.electronforge.io/interfaces/_electron_forge_publisher_s3.PublisherS3Config.html"},(0,a.yg)("inlineCode",{parentName:"a"},"PublisherS3Config")),"."),(0,a.yg)("p",null,'{% code title="forge.config.js" %}'),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"module.exports = {\n  // ...\n  publishers: [\n    {\n      name: '@electron-forge/publisher-s3',\n      config: {\n        bucket: 'my-bucket',\n        public: true\n      }\n    }\n  ]\n};\n")),(0,a.yg)("p",null,"{% endcode %}"),(0,a.yg)("h3",{id:"key-management"},"Key management"),(0,a.yg)("p",null,"By default, the S3 publisher will upload its objects to the ",(0,a.yg)("inlineCode",{parentName:"p"},"{prefix}/{platform}/{arch}/{name}")," key, where:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"{prefix}")," is the value of the ",(0,a.yg)("inlineCode",{parentName:"li"},"config.folder")," option (defaults to the ",(0,a.yg)("inlineCode",{parentName:"li"},'"name"')," field in your package.json)."),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"{platform}")," is the target platform for the artifact you are publishing."),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"{arch}")," is the target architecture for the artifact you are publishing."),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"{name}")," is the file name of the artifact you are publishing.")),(0,a.yg)("p",null,'{% hint style="warning" %}\nIf you run the Publish command multiple times on the same platform for the same version (e.g. simultaneously publishing ',(0,a.yg)("inlineCode",{parentName:"p"},"ia32")," and ",(0,a.yg)("inlineCode",{parentName:"p"},"x64")," Windows artifacts), your uploads can get overwritten in the S3 bucket."),(0,a.yg)("p",null,"To avoid this problem, you can use the ",(0,a.yg)("inlineCode",{parentName:"p"},"keyResolver")," option to generate the S3 key programmatically."),(0,a.yg)("p",null,'{% code title="forge.config.js" %}'),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"{\n  name: '@electron-forge/publisher-s3',\n  config: {\n    // ...\n    keyResolver: (fileName, platform, arch) => {\n      return `some-prefix/${platform}/${arch}/${filename}`\n    }\n    // ...\n  }\n}\n")),(0,a.yg)("p",null,"{% endcode %}\n{% endhint %}"),(0,a.yg)("h3",{id:"auto-updating-from-s3"},"Auto updating from S3"),(0,a.yg)("p",null,"You can configure Electron's built-in ",(0,a.yg)("a",{parentName:"p",href:"https://www.electronjs.org/docs/latest/api/auto-updater"},(0,a.yg)("inlineCode",{parentName:"a"},"autoUpdater"))," module to use the artifacts published by the S3 publisher. This is a two-step process:"),(0,a.yg)("p",null,"First, you must configure ",(0,a.yg)("inlineCode",{parentName:"p"},"@electron-forge/publisher-s3")," to publish your files into an auto-updater compatible layout and use ",(0,a.yg)("inlineCode",{parentName:"p"},"@electron-forge/maker-zip")," + ",(0,a.yg)("inlineCode",{parentName:"p"},"@electron-forge/maker-squirrel")," to build your application."),(0,a.yg)("p",null,'{% code title="forge.config.js" %}'),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"module.exports = {\n  // ...\n  makers: [\n    {\n      name: '@electron-forge/maker-zip',\n      config: (arch) => ({\n        // Note that we must provide this S3 URL here\n        // in order to support smooth version transitions\n        // especially when using a CDN to front your updates\n        macUpdateManifestBaseUrl: `https://my-bucket.s3.amazonaws.com/my-app-updates/darwin/${arch}`\n      })\n    },\n    {\n      name: '@electron-forge/maker-squirrel',\n      config: (arch) => ({\n        // Note that we must provide this S3 URL here\n        // in order to generate delta updates\n        remoteReleases: `https://my-bucket.s3.amazonaws.com/my-app-updates/win32/${arch}`\n      })\n    }\n  ],\n  publishers: [\n    {\n      name: '@electron-forge/publisher-s3',\n      config: {\n        bucket: 'my-bucket',\n        public: true\n      }\n    }\n  ]\n};\n")),(0,a.yg)("p",null,"{% endcode %}"),(0,a.yg)("p",null,"With Forge configured correctly, the second step is to configure the ",(0,a.yg)("inlineCode",{parentName:"p"},"autoUpdater")," module inside your app's main process. The simplest form is shown below but you might want to hook additional events to show UI to your user or ask them if they want to update your app right now."),(0,a.yg)("p",null,'{% code title="main.js" %}'),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-javascript"},"const { updateElectronApp, UpdateSourceType } = require('update-electron-app');\n\nupdateElectronApp({\n  updateSource: {\n    type: UpdateSourceType.StaticStorage,\n    baseUrl: `https://my-bucket.s3.amazonaws.com/my-app-updates/${process.platform}/${process.arch}`\n  }\n});\n")),(0,a.yg)("p",null,"{% endcode %}"))}g.isMDXComponent=!0}}]);