"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3729],{5680:(e,n,t)=>{t.d(n,{xA:()=>g,yg:()=>u});var a=t(6540);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var p=a.createContext({}),s=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):r(r({},n),e)),t},g=function(e){var n=s(e.components);return a.createElement(p.Provider,{value:n},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},y=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,g=l(e,["components","mdxType","originalType","parentName"]),c=s(t),y=o,u=c["".concat(p,".").concat(y)]||c[y]||d[y]||i;return t?a.createElement(u,r(r({ref:n},g),{},{components:t})):a.createElement(u,r({ref:n},g))}));function u(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var i=t.length,r=new Array(i);r[0]=y;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l[c]="string"==typeof e?e:o,r[1]=l;for(var s=2;s<i;s++)r[s]=t[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,t)}y.displayName="MDXCreateElement"},4621:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=t(8168),o=(t(6540),t(5680));const i={description:"Code signing is a security technology that you use to certify that an app was created by you."},r="Signing a macOS app",l={unversionedId:"guides/code-signing/code-signing-macos",id:"guides/code-signing/code-signing-macos",title:"Signing a macOS app",description:"Code signing is a security technology that you use to certify that an app was created by you.",source:"@site/docs/guides/code-signing/code-signing-macos.md",sourceDirName:"guides/code-signing",slug:"/guides/code-signing/code-signing-macos",permalink:"/forge-docu/guides/code-signing/code-signing-macos",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/guides/code-signing/code-signing-macos.md",tags:[],version:"current",frontMatter:{description:"Code signing is a security technology that you use to certify that an app was created by you."},sidebar:"tutorialSidebar",previous:{title:"Signing a Windows app",permalink:"/forge-docu/guides/code-signing/code-signing-windows"},next:{title:"Custom App Icons",permalink:"/forge-docu/guides/create-and-add-icons"}},p={},s=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installing Xcode",id:"installing-xcode",level:3},{value:"Obtaining signing certificates",id:"obtaining-signing-certificates",level:3},{value:"Configuring Forge",id:"configuring-forge",level:2},{value:"osxSign options",id:"osxsign-options",level:3},{value:"Customizing entitlements",id:"customizing-entitlements",level:4},{value:"osxNotarize options",id:"osxnotarize-options",level:3},{value:"Option 1: Using an app-specific password",id:"option-1-using-an-app-specific-password",level:4},{value:"Option 2: Using an App Store Connect API key",id:"option-2-using-an-app-store-connect-api-key",level:4},{value:"Option 3: Using a keychain",id:"option-3-using-a-keychain",level:4},{value:"Example configuration",id:"example-configuration",level:3}],g={toc:s},c="wrapper";function d(e){let{components:n,...t}=e;return(0,o.yg)(c,(0,a.A)({},g,t,{components:n,mdxType:"MDXLayout"}),(0,o.yg)("h1",{id:"signing-a-macos-app"},"Signing a macOS app"),(0,o.yg)("p",null,"On macOS, there are two layers of security technology for application distribution: ",(0,o.yg)("strong",{parentName:"p"},"code signing")," and ",(0,o.yg)("strong",{parentName:"p"},"notarization"),"."),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Code Signing")," is the act of certifying the identity of the app's author and ensuring it was not tampered with before distribution."),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Notarization")," is an extra verification step where the app is sent to Apple servers for an automated malware scan.")),(0,o.yg)("p",null,'{% hint style="info" %}\nFrom macOS 10.15 (Catalina) onwards, your application needs to be ',(0,o.yg)("strong",{parentName:"p"},"both code signed and notarized")," to run on a user's machine without disabling additional operating system security checks."),(0,o.yg)("p",null,"The exception is for Mac App Store (MAS) apps, where notarization is not required because the MAS submission process involves a similar automated check.\n{% endhint %}"),(0,o.yg)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.yg)("h3",{id:"installing-xcode"},"Installing Xcode"),(0,o.yg)("p",null,(0,o.yg)("a",{parentName:"p",href:"https://developer.apple.com/xcode/"},"Xcode")," is Apple's integrated development environment (IDE) for development on macOS, iOS, and other platforms."),(0,o.yg)("p",null,"Although Electron does not integrate tightly with the IDE itself, Xcode is a helpful tool for installing code signing certificates (see next section) and is ",(0,o.yg)("strong",{parentName:"p"},"required")," for notarization."),(0,o.yg)("h3",{id:"obtaining-signing-certificates"},"Obtaining signing certificates"),(0,o.yg)("p",null,"Code signing certificates for macOS apps can only be obtained through Apple by purchasing a membership to the ",(0,o.yg)("a",{parentName:"p",href:"https://developer.apple.com/programs/"},"Apple Developer Program"),"."),(0,o.yg)("p",null,"To sign Electron apps, you may require two separate certificates:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},"The ",(0,o.yg)("strong",{parentName:"li"},"Developer ID Installer")," certificate is for apps distributed to the Mac App Store."),(0,o.yg)("li",{parentName:"ul"},"The ",(0,o.yg)("strong",{parentName:"li"},"Developer ID Application")," certificate is for apps distributed outside the Mac App Store.")),(0,o.yg)("p",null,"Once you have an Apple Developer Program membership, you first need to install them onto your machine. We recommend ",(0,o.yg)("a",{parentName:"p",href:"https://help.apple.com/xcode/mac/current/#/dev3a05256b8"},"loading them through Xcode"),"."),(0,o.yg)("p",null,'{% hint style="success" %}\n',(0,o.yg)("strong",{parentName:"p"},"Verifying your certificate is installed")),(0,o.yg)("p",null,"Once you have installed your certificate, you can check available code signing certificates in your terminal using the following shell command:"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-shell"},"security find-identity -p codesigning -v\n")),(0,o.yg)("p",null,"{% endhint %}"),(0,o.yg)("h2",{id:"configuring-forge"},"Configuring Forge"),(0,o.yg)("p",null,"In Electron Forge, macOS apps are signed and notarized at the ",(0,o.yg)("strong",{parentName:"p"},"Package")," step by the ",(0,o.yg)("inlineCode",{parentName:"p"},"electron-packager")," library. There is a separate option within your Forge ",(0,o.yg)("inlineCode",{parentName:"p"},"packagerConfig")," for each one of these settings."),(0,o.yg)("h3",{id:"osxsign-options"},"osxSign options"),(0,o.yg)("p",null,'{% hint style="info" %}\nUnder the hood, Electron Forge uses the ',(0,o.yg)("a",{parentName:"p",href:"https://github.com/electron/osx-sign"},(0,o.yg)("inlineCode",{parentName:"a"},"@electron/osx-sign"))," tool to sign your macOS application.\n{% endhint %}"),(0,o.yg)("p",null,"To enable code signing on macOS, ensure that ",(0,o.yg)("inlineCode",{parentName:"p"},"packagerConfig.osxSign")," exists in your Forge configuration."),(0,o.yg)("p",null,'{% code title="forge.config.js" %}'),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-javascript"},"module.exports = {\n  packagerConfig: {\n    osxSign: {} // object must exist even if empty\n  }\n};\n")),(0,o.yg)("p",null,"{% endcode %}"),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"osxSign")," config comes with defaults that work out of the box in most cases, so we recommend you start with an empty configuration object."),(0,o.yg)("p",null,"For a full list of configuration options, see the ",(0,o.yg)("a",{parentName:"p",href:"https://js.electronforge.io/modules/_electron_forge_shared_types.InternalOptions.html#OsxSignOptions"},(0,o.yg)("inlineCode",{parentName:"a"},"OsxSignOptions"))," type in the Forge API docs. For more detailed information on how to configure these options, see the ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/electron/osx-sign"},(0,o.yg)("inlineCode",{parentName:"a"},"@electron/osx-sign")," documentation"),"."),(0,o.yg)("h4",{id:"customizing-entitlements"},"Customizing entitlements"),(0,o.yg)("p",null,"A common use case for modifying the default ",(0,o.yg)("inlineCode",{parentName:"p"},"osxSign")," configuration is to customize its entitlements. In macOS, ",(0,o.yg)("strong",{parentName:"p"},"entitlements")," are privileges that grant apps certain capabilities (e.g. access to the camera, microphone, or USB devices). These are stored within the code signature in an app's executable file."),(0,o.yg)("p",null,"By default, the ",(0,o.yg)("inlineCode",{parentName:"p"},"@electron/osx-sign")," tool comes with a set of entitlements that should work on both MAS or direct distribution targets. See the complete set of default entitlement files ",(0,o.yg)("a",{parentName:"p",href:"https://github.com/electron/osx-sign/tree/main/entitlements"},"on GitHub"),"."),(0,o.yg)("p",null,'{% code title="forge.config.js" %}'),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-javascript"},"module.exports = {\n  // ...\n  packagerConfig: {\n    // ...\n    osxSign: {\n      optionsForFile: (filePath) => {\n        // Here, we keep it simple and return a single entitlements.plist file.\n        // You can use this callback to map different sets of entitlements\n        // to specific files in your packaged app.\n        return {\n          entitlements: 'path/to/entitlements.plist'\n        };\n      }\n    }\n  }\n  // ...\n};\n")),(0,o.yg)("p",null,"{% endcode %}"),(0,o.yg)("p",null,"For further reading on entitlements, see the following pages in Apple developer documentation:"),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"https://developer.apple.com/documentation/bundleresources/entitlements"},"Entitlements")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("a",{parentName:"li",href:"https://developer.apple.com/documentation/security/hardened_runtime"},"Hardened Runtime"))),(0,o.yg)("h3",{id:"osxnotarize-options"},"osxNotarize options"),(0,o.yg)("p",null,'{% hint style="info" %}\nUnder the hood, Electron Forge uses the ',(0,o.yg)("a",{parentName:"p",href:"https://github.com/electron/notarize"},(0,o.yg)("inlineCode",{parentName:"a"},"@electron/notarize"))," tool to notarize your macOS application.\n{% endhint %}"),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"osxNotarize")," configuration object only supports ",(0,o.yg)("inlineCode",{parentName:"p"},"notarytool")," as of Electron Forge v7.0.0."),(0,o.yg)("p",null,"The ",(0,o.yg)("inlineCode",{parentName:"p"},"notarytool")," command has three authentication options, which are detailed below. Note that you will want to use a ",(0,o.yg)("inlineCode",{parentName:"p"},"forge.config.js")," configuration so that you can load environment variables into your Forge config."),(0,o.yg)("p",null,'{% hint style="danger" %}\n',(0,o.yg)("strong",{parentName:"p"},"Keep your authentication details private")),(0,o.yg)("p",null,"You should never store authentication info in plaintext in your configuration. In the examples below, credentials are stored as environment variables and accessed via the Node.js ",(0,o.yg)("a",{parentName:"p",href:"https://nodejs.org/dist/latest-v16.x/docs/api/process.html#processenv"},(0,o.yg)("inlineCode",{parentName:"a"},"process.env"))," object.\n{% endhint %}"),(0,o.yg)("h4",{id:"option-1-using-an-app-specific-password"},"Option 1: Using an app-specific password"),(0,o.yg)("p",null,"You can generate an ",(0,o.yg)("a",{parentName:"p",href:"https://support.apple.com/en-us/HT204397"},"app-specific password")," from Apple to provide your credentials to ",(0,o.yg)("inlineCode",{parentName:"p"},"notarytool"),". This password will need to be regenerated if you change your Apple ID password."),(0,o.yg)("p",null,"There are two mandatory fields for ",(0,o.yg)("inlineCode",{parentName:"p"},"osxNotarize")," if you are using this strategy:"),(0,o.yg)("table",null,(0,o.yg)("thead",{parentName:"table"},(0,o.yg)("tr",{parentName:"thead"},(0,o.yg)("th",{parentName:"tr",align:null},"Field"),(0,o.yg)("th",{parentName:"tr",align:null},"Type"),(0,o.yg)("th",{parentName:"tr",align:null},"Description"))),(0,o.yg)("tbody",{parentName:"table"},(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},(0,o.yg)("inlineCode",{parentName:"td"},"appleId")),(0,o.yg)("td",{parentName:"tr",align:null},"string"),(0,o.yg)("td",{parentName:"tr",align:null},"Apple ID associated with your Apple Developer account")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},(0,o.yg)("inlineCode",{parentName:"td"},"appleIdPassword")),(0,o.yg)("td",{parentName:"tr",align:null},"string"),(0,o.yg)("td",{parentName:"tr",align:null},"App-specific password")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},(0,o.yg)("inlineCode",{parentName:"td"},"teamId")),(0,o.yg)("td",{parentName:"tr",align:null},"string"),(0,o.yg)("td",{parentName:"tr",align:null},"The Apple Team ID you want to notarize under. You can find Team IDs for team you belong to by going to ",(0,o.yg)("a",{parentName:"td",href:"https://developer.apple.com/account/#/membership"},(0,o.yg)("inlineCode",{parentName:"a"},"https://developer.apple.com/account/#/membership")))))),(0,o.yg)("p",null,'{% code title="forge.config.js" %}'),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-javascript"},"module.exports = {\n  // ...\n  packagerConfig: {\n    // ...\n    osxNotarize: {\n      tool: 'notarytool',\n      appleId: process.env.APPLE_ID,\n      appleIdPassword: process.env.APPLE_PASSWORD,\n      teamId: process.env.APPLE_TEAM_ID\n    }\n  }\n  // ...\n};\n")),(0,o.yg)("p",null,"{% endcode %}"),(0,o.yg)("p",null,'{% hint style="warning" %}\nDespite the name, ',(0,o.yg)("inlineCode",{parentName:"p"},"appleIdPassword")," is ",(0,o.yg)("strong",{parentName:"p"},"not")," the password for your Apple ID account.\n{% endhint %}"),(0,o.yg)("h4",{id:"option-2-using-an-app-store-connect-api-key"},"Option 2: Using an App Store Connect API key"),(0,o.yg)("p",null,"You can generate an App Store Connect API key to authenticate ",(0,o.yg)("inlineCode",{parentName:"p"},"notarytool")," by going to the ",(0,o.yg)("a",{parentName:"p",href:"https://appstoreconnect.apple.com/access/api"},"App Store Connect access page"),' and using the "Keys" tab. This API key will look something like ',(0,o.yg)("inlineCode",{parentName:"p"},"AuthKey_ABCD123456.p8")," and can only be downloaded once."),(0,o.yg)("p",null,"There are three mandatory fields for ",(0,o.yg)("inlineCode",{parentName:"p"},"osxNotarize")," if you are using this strategy:"),(0,o.yg)("table",null,(0,o.yg)("thead",{parentName:"table"},(0,o.yg)("tr",{parentName:"thead"},(0,o.yg)("th",{parentName:"tr",align:null},"Field"),(0,o.yg)("th",{parentName:"tr",align:null},"Type"),(0,o.yg)("th",{parentName:"tr",align:null},"Description"))),(0,o.yg)("tbody",{parentName:"table"},(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},(0,o.yg)("inlineCode",{parentName:"td"},"appleApiKey")),(0,o.yg)("td",{parentName:"tr",align:null},"string"),(0,o.yg)("td",{parentName:"tr",align:null},"Filesystem path string to your API key file.")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},(0,o.yg)("inlineCode",{parentName:"td"},"appleApiKeyId")),(0,o.yg)("td",{parentName:"tr",align:null},"string"),(0,o.yg)("td",{parentName:"tr",align:null},"10-character alphanumeric ID string. In the previous ",(0,o.yg)("inlineCode",{parentName:"td"},"AuthKey_ABCD123456.p8")," example, this would be ",(0,o.yg)("inlineCode",{parentName:"td"},"ABCD123456"),".")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},(0,o.yg)("inlineCode",{parentName:"td"},"appleApiIssuer")),(0,o.yg)("td",{parentName:"tr",align:null},"string"),(0,o.yg)("td",{parentName:"tr",align:null},'UUID that identifies the API key issuer. You will find this ID in the "Keys" tab where you generated your API key.')))),(0,o.yg)("p",null,'{% code title="forge.config.js" %}'),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-javascript"},"module.exports = {\n  // ...\n  packagerConfig: {\n    // ...\n    osxNotarize: {\n      tool: 'notarytool',\n      appleApiKey: process.env.APPLE_API_KEY,\n      appleApiKeyId: process.env.APPLE_API_KEY_ID,\n      appleApiIssuer: process.env.APPLE_API_ISSUER\n    }\n  }\n  // ...\n};\n")),(0,o.yg)("p",null,"{% endcode %}"),(0,o.yg)("h4",{id:"option-3-using-a-keychain"},"Option 3: Using a keychain"),(0,o.yg)("p",null,"Instead of providing environment variables to the Forge config passed to ",(0,o.yg)("inlineCode",{parentName:"p"},"notarytool"),", you can choose to use a macOS ",(0,o.yg)("a",{parentName:"p",href:"https://support.apple.com/en-ca/guide/mac-help/mchlf375f392/mac"},"keychain")," containing either set of credentials (either Option 1 or Option 2 above)."),(0,o.yg)("p",null,"You can do this directly in your terminal via the ",(0,o.yg)("inlineCode",{parentName:"p"},"notarytool store-credentials")," command. For usage information, you can refer to the man page for ",(0,o.yg)("inlineCode",{parentName:"p"},"notarytool"),":"),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-bash"},"man notarytool\n")),(0,o.yg)("p",null,"There are two mandatory fields for ",(0,o.yg)("inlineCode",{parentName:"p"},"osxNotarize")," if you are using this strategy:"),(0,o.yg)("table",null,(0,o.yg)("thead",{parentName:"table"},(0,o.yg)("tr",{parentName:"thead"},(0,o.yg)("th",{parentName:"tr",align:null},"Field"),(0,o.yg)("th",{parentName:"tr",align:null},"Type"),(0,o.yg)("th",{parentName:"tr",align:null},"Description"))),(0,o.yg)("tbody",{parentName:"table"},(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},(0,o.yg)("inlineCode",{parentName:"td"},"keychain")),(0,o.yg)("td",{parentName:"tr",align:null},"string"),(0,o.yg)("td",{parentName:"tr",align:null},"Name of (or path to) the keychain containing the profile with your credentials.")),(0,o.yg)("tr",{parentName:"tbody"},(0,o.yg)("td",{parentName:"tr",align:null},(0,o.yg)("inlineCode",{parentName:"td"},"keychainProfile")),(0,o.yg)("td",{parentName:"tr",align:null},"string"),(0,o.yg)("td",{parentName:"tr",align:null},"Name of the keychain profile containing your notarization credentials.")))),(0,o.yg)("p",null,'{% code title="forge.config.js" %}'),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-javascript"},"module.exports = {\n  // ...\n  packagerConfig: {\n    // ...\n    osxNotarize: {\n      tool: 'notarytool',\n      keychain: 'my-keychain',\n      keychainProfile: 'my-keychain-profile'\n    }\n  }\n  // ...\n};\n")),(0,o.yg)("p",null,"{% endcode %}"),(0,o.yg)("h3",{id:"example-configuration"},"Example configuration"),(0,o.yg)("p",null,"Below is a minimal Forge configuration for ",(0,o.yg)("inlineCode",{parentName:"p"},"osxSign")," and ",(0,o.yg)("inlineCode",{parentName:"p"},"osxNotarize"),"."),(0,o.yg)("p",null,'{% code title="forge.config.js" %}'),(0,o.yg)("pre",null,(0,o.yg)("code",{parentName:"pre",className:"language-javascript"},"module.exports = {\n  packagerConfig: {\n    osxSign: {},\n    osxNotarize: {\n      tool: 'notarytool',\n      appleId: process.env.APPLE_ID,\n      appleIdPassword: process.env.APPLE_PASSWORD,\n      teamId: process.env.APPLE_TEAM_ID\n    }\n  }\n};\n")),(0,o.yg)("p",null,"{% endcode %}"))}d.isMDXComponent=!0}}]);